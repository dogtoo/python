function controlbar(options) {
  this.options = options;
  if (typeof this.options.begin === 'undefined')  this.options.begin = 0;
  if (typeof this.options.end === 'undefined')    this.options.end = 0;
  if (typeof this.options.length === 'undefined') this.options.length = 0;
  if (typeof this.options.range === 'undefined') this.options.range = 0;
  if (typeof this.options.step === 'undefined') this.options.step = 1;
  if (typeof this.options.dec === 'undefined') this.options.dec = 'add'; //add:+ / sub:-
  if (typeof this.options.order === 'undefined') this.options.order = 'asc';
  if (typeof this.options.axial  === 'undefined') this.options.axial = 'ver';
  if (typeof this.options.datasource  === 'undefined') this.options.datasource = '';
  this.options.load = false;
  this.options.onMove = false;
}

controlbar.prototype = {
    initialize : function () {
        if (!this.reBuild) {
            if (this.options.datasource != '') {
                this.options.length = this.data[this.options.datasource].length;
            }
            if (this.options.order === 'asc') {
                this.options.end = this.options.begin + this.options.range - 1;
            } else if (this.options.order === 'desc') {
                this.options.begin = this.options.length - this.options.range;
            }
        }
    },
    start : function () {
        var ctx = this.ctx;
        ctx.save();
        if (typeof this.options.color == 'string') ctx.fillStyle = this.options.color;
        ctx.translate(this.paintRegion[paintName + '.x'], this.paintRegion[paintName + '.y']);
    },
    end : function () {
        this.ctx.restore();
        this.options.build = true;
    },
    paintItems : function() {
        
    },
    toString: function() {
        return 'controlbar';
    },
    mousedown: function(offset) {
        if (this.implement.isTouch.call(this, offset)) {
            console.log(this.paintName + ' isTouch');
            this.options.onMove = true;
        }
    },
    setNext: function() {
        var dec = 1;
        var step = this.options.step;
        if (this.options.order === 'asc') {
            if (this.options.dec === 'sub') dec = -1;
            if (this.options.begin + (this.options.step * dec) < 0 ) return;
            if (this.options.end + (this.options.step * dec) > this.options.length ) step = this.options.length- this.options.end;
            this.options.begin = this.options.begin + (this.options.step * dec);
            this.options.end = this.options.end + (this.options.step * dec);
            
            
        } else if (this.options.order === 'desc') {
            if (this.options.dec === 'add') dec = -1;
            if (this.options.begin + (this.options.step * dec) < 0 ) return;
            if (this.options.end + (this.options.step * dec) > this.options.length ) step = this.options.length- this.options.end;
            this.options.begin = this.options.begin + (this.options.step * dec);
            this.options.end = this.options.end + (this.options.step * dec);
        }
    },
    mousemove: function(offset) {
        if (this.options.onMove) {
            if (this.options.axial === 'ver') {
                if (offset.movementX > 0)
                    this.options.dec = 'add';
                else
                    this.options.dec = 'sub';
            }
            else if (this.options.axial === 'hor') {
                if (offset.movementY > 0)
                    this.options.dec = 'add';
                else
                    this.options.dec = 'sub';
            }
            if ((this.options.axial === 'ver' && offset.movementX != 0) || (this.options.axial === 'hor' && offset.movementY != 0)){
                this.implement.setNext.call(this);
                
                this.begin = this.options.begin;
                this.end = this.options.end;
                this.reInit = true;
                this.reBuild = true;
            }
        }
    },    
    mouseup: function(offset) {
        if (this.options.onMove) {
            this.options.onMove = false;
        }
    },
    reBuild: function() {
        
    },
    isTouch: function(offset) {
        if (offset.offsetX >= this.paintRegion[this.paintName + '.x']
         && offset.offsetY >= this.paintRegion[this.paintName + '.y']
         && offset.offsetX <= this.paintRegion[this.paintName + '.x'] + this.paintRegion[this.paintName + '.width']
         && offset.offsetY <= this.paintRegion[this.paintName + '.y'] + this.paintRegion[this.paintName + '.height'])
            return true;
        return false;
    }
}
